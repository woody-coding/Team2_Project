<!DOCTYPE html>
<html>
<head>
<script src="/js/jquery-3.7.1.min.js"></script>
<meta charset="UTF-8">
<title>Insert title here</title>
<style type="text/css">
	.actor-area{
            width: 1200px;
            box-sizing: border-box;
            margin: 0 auto;
            display: flex;
            align-items: center; /* 수직 중앙 정렬 */
            margin-top: 30px;
        }
    section {
            width: 1200px;
            box-sizing: border-box;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center; /* 수직 중앙 정렬 */
            margin-top: 30px;
        }
        .actor-area{
            width: 1200px;
            box-sizing: border-box;
            margin: 0 auto;
            display: flex;
            align-items: center; /* 수직 중앙 정렬 */
            margin-top: 30px;
        }
        .poster{
            width: 180px; 
            height: 250px; 
            border: 1px solid black;
            cursor: pointer;
            display: flex;
            justify-content: center; /* 수평 가운데 정렬 */
            align-items: center; /* 수직 가운데 정렬 */
            margin-top: -52px;
            background-size: cover; /* cover: 배경 이미지를 요소를 완전히 덮도록 설정 */
    		background-position: center; /* 중앙 정렬 */
    		background-repeat: no-repeat; /* 이미지를 반복하지 않도록 설정 */
        }
        .place-field {
		    background-color: #f0f0f0; /* 읽기 전용 필드의 배경색 */
		    border: 1px solid #ccc; /* 테두리 스타일 */
		    color: #333; /* 텍스트 색상 */
		    /* 필요에 따라 추가 스타일 */
		}
		.count-container {
		    position: relative; /* 부모 요소를 기준으로 절대 위치 지정 */
		}
		
		.input-field {
		    width: 115px; /* 예시 너비 */
		    cursor: pointer;
		    margin-bottom: 10px; /* 각 입력 필드 사이의 간격 */
		    /* 기타 스타일 */
		}
		
		#timeInput1, #timeInput2 {
		    position: absolute;
		    left: 0; /* 입력 필드와 같은 수평 위치 */
		    display: none; /* 기본적으로 숨김 */
		    z-index: 100; /* 다른 요소 위에 표시 */
		}
		
		#timeInput1 {
		    top: 53px; /* countInput1 아래에 위치 */
		    margin-left: 102px;
		
		}
		
		#timeInput2 {
		    top: 53px;/* countInput2 아래에 위치 */
		    margin-left: 266px;
		} 
		.age-seat-container {
		    margin-top: 10px; /* 위쪽 여백 */
		}
		
		.age-select {
		    margin-left: -1px; /* 왼쪽 여백 */
		    padding: 5px; /* 내부 여백 */
		    /* 필요에 따라 추가 스타일 */
		}
		.calendar {
            display: inline-block;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            font-family: Arial, sans-serif;
            width: 300px;
			margin-top: 20px;
			margin-bottom: 20px;
        }
        .calendar-header {
            text-align: center;
            margin-bottom: 10px;
        }
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
        }
        .calendar-days div {
            padding: 5px;
            margin: 2px;
            cursor: pointer;
            border: 1px solid transparent;
            border-radius: 3px;
        }
        .calendar-days div:hover {
            background-color: #f0f0f0;
        }
        .selected, .selected-range {
            background-color: #ff9400;
            color: white;
        }

		/*datepicker*/
		.calendar {
			background-color: #ffffff;
			border-radius: 8px;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
			width: 320px;
			padding: 20px;
		}

		.calendar-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 10px;
			font-size: 18px;
			font-weight: bold;
			color: #333;
		}

		.calendar-header button {
			background-color: #ff9400;
			color: white;
			border: none;
			border-radius: 5px;
			padding: 5px 10px;
			cursor: pointer;
			font-size: 14px;
			transition: background-color 0.3s ease;
		}

		.calendar-header button:hover {
			background-color: #ff9400;
		}

		.calendar-days {
			display: grid;
			grid-template-columns: repeat(7, 1fr);
			gap: 5px;
		}
        
		.day.disabled {
		    color: gray;
		    pointer-events: none; /* 클릭 불가 */
		}
		.input{
		    height: 30px;
		    margin-top: 18px;
		    font-size: 16px;
		    margin-left: 19px;
		}
		
		.fixed-button {
		    bottom: 10px;
		    left: 50%;
		    transform: translateX(-392%);
		    padding: 10px 20px;
		    background-color: #ff9400;
		    color: white;
		    border: none;
		    border-radius: 5px;
		    cursor: pointer;
		    margin-top: 225px;
		    font-size: 14px;
		}
		
		.fixed-button:hover {
		    background-color: #ff9400;
		}
		
		.title{
		    font-size: 18px;
		    font-weight: 600;
		}
		.actBox {
		            display: flex;
		            flex-direction: column; /* 수직 정렬 */
		            align-items: center; /* 가운데 정렬 */
		            width: 130px;
		            position: relative; /* 하트 위치 조정을 위한 설정 */
		            margin-right: 30px; /* actBox 간의 간격 추가 */
		            margin-top: 25px;
		            border: 1px solid #dddddd; /* 테두리 추가 */
		        }
        .actImg {
            height: 130px; /* 높이 설정 */
            width: 130px; /* 너비 설정 */
            overflow: hidden; /* 자식 요소가 부모의 경계를 넘어가도록 설정 */
            border: none; /* 테두리 제거 */
        }
        .actor {
            height: 130px; /* 높이 설정 */
            width: 130px; /* 너비 설정 */
            object-fit: cover; /* 이미지 비율 유지 */
        }

.actor-input-container {
    display: flex; /* 플렉스 컨테이너로 설정 */
    gap: 11px; /* 각 actBox 사이의 간격 */
}

.actBox {
    display: flex;
    flex-direction: column; /* 내부 요소를 수직으로 정렬 */
    align-items: center; /* 내부 요소를 수평 중앙 정렬 */
    border: 1px solid #dddddd; /* 테두리 추가 */
    /* 필요에 따라 추가 스타일 */
}

.actBox:hover {
    background-color: #f0f0f0; /* hover 시 배경색 변경 */
    cursor: pointer; /* hover 시 커서 변경 */
}

.modal {
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* 반투명 배경 */
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    width: 80%;
    max-width: 500px;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.close-button {
    position: absolute;
    top: 10px;
    right: 20px;
    cursor: pointer;
    font-size: 20px;
    font-weight: bold;
}

</style>

</head>
<body>
    <form action="/admin/showInsert" method="post" enctype="multipart/form-data">
        <section class="text-area">
            <div class="posterBox">
                <div class="poster" id="poster" style="background-size: cover; background-position: center; background-repeat: no-repeat;">
                    사진을 선택해주세요
                </div>
                <input type="file" name="file" id="fileInput" style="display: none;" accept=".jpg, .jpeg, .png"/>
            </div>
            <div class="showInfoBox" style="margin-left: 50px;margin-right: 50px;">
                <div class="title-input-container">
                    <span class="title">제 목</span>
                    <input type="text" name="showTitle" class="input-title-field input" placeholder="제목을 입력해주세요" style="width: 278px; margin-left: 55px;"/>
                </div>
                <div class="place-container">
                    <span class="title">공연 장소</span>
                    <input type="text" name="showPlace" class="place-field input" value="멀티캠퍼스 멀티24 3층 1홀" readonly style="width: 280px;"/>
                </div>
                <div class="category-container">
                    <span class="title">공연 카테고리</span>
                    <select name="showCate" class="input" required>
                        <option value="">선택하세요</option>
                        <option value="뮤지컬">뮤지컬</option>
                        <option value="콘서트">콘서트</option>
                        <option value="스포츠">스포츠</option>
                        <option value="전시/행사">전시/행사</option>
                        <option value="클래식">클래식</option>
                        <option value="아동/가족">아동/가족</option>
                        <option value="연극">연극</option>
                    </select>
                </div>
                <div class="date-container">
                    <span class="title">공연 기간</span>
                    <input type="text" id="startDateField" name="startDate" class="start-date-field input" placeholder="시작 날짜" readonly style="width: 115px; margin-right: 8px;"/>
                    <span class="title">~</span>
                    <input type="text" id="endDateField" name="endDate" class="end-date-field input" placeholder="종료 날짜" readonly style="width: 115px; margin-left: 8px;"/>
                	<input type="hidden" name="openDate" id="openDateField" />
                </div>
                <div class="count-container">
    				<span class="title">회 차</span>
				    <input type="text" id="countInput1" class="input-field input" value="1회" readonly style="margin-left: 54px; margin-right: 16px;" />
    <input type="time" id="timeInput1" name="showStartTime" step="3600" required style="display: inline-block;" />
					<span class="title">러닝 타임</span>
                    <input type="text" id="playtime" name="showPlayTime" class="input-showPlayTime-field input" placeholder="몇분" style="width: 42px; margin-left: 10px;">
                    <span class="minute">분</span>
				</div>

                <div class="age-seat-container">
                    <span class="title">관람 연령</span>
                    <select id="ageSelect" name="showRating" class="age-select input" style="margin-left: 17px;">
                        <option value="전체 이용가">전체 이용가</option>
                        <option value="12">12세</option>
                        <option value="15">15세</option>
                        <option value="19">19세</option>
                    </select>
                    <span class="title input">좌석 수</span>
                    <input type="text" name="totSeat" class="input-price-field input" value="123" readonly style="width: 51px;"/>
                    <input type="hidden" name="leftSeat" value="123" />
                    <span class="seat">석</span>
                </div>
                <div class="price-container">
                    <span class="title">가 격</span>
                    <input type="text" id="inputPriceField" name="showPrice" class="input-price-field input" placeholder="가격" style="width: 100px; margin-left: 53px;">
                    <span class="won">원</span>
                </div>  
            </div>
            <div class="calender-container" style="border: 1px solid #dddddd;height: 285px;margin-top: -22px;border-radius: 6px;width: 320px;">
                <div class="calendar-header">
                    <button type="button" id="prevMonth">&lt;</button>
                    <span id="currentMonthYear">December 2024</span>
                    <button type="button" id="nextMonth">&gt;</button>
                </div>
                <div class="calendar-days" id="calendarDays"></div>
            </div>  
            <button type="button" id="resetSelection" class="fixed-button">재선택</button>    
        </section>
        <section class="actor-area">
        <div class="actor-container">
            <span class="title title-actor" style="margin-right: 1002px;">출연 배우</span>
            <div class="actor-input-container">
                <div class="actBox">
                    <div class="actImg">
                        <img alt="" src="68227042_20071227.jpg" class="actor"> <!-- 여기에 배우 이미지 URL 추가 -->
                    </div>
                    <div class="actName" style="margin-top: 10px;">박상철</div>
                </div>
                <div class="actBox">
                    <div class="actImg">
                        <img alt="" src="68227042_20071227.jpg" class="actor"> <!-- 여기에 배우 이미지 URL 추가 -->
                    </div>
                    <div class="actName" style="margin-top: 10px;">이름이</div>
                </div>
                <div class="actBox">
                    <div class="actImg">
                        <img alt="" src="68227042_20071227.jpg" class="actor"> <!-- 여기에 배우 이미지 URL 추가 -->
                    </div>
                    <div class="actName" style="margin-top: 10px;">이름이</div>
                </div>
                <div class="actBox">
                    <div class="actImg">
                        <img alt="" src="" class="actor"> <!-- 여기에 배우 이미지 URL 추가 -->
                    </div>
                    <div class="actName" style="margin-top: 10px;">이름이</div>
                </div>
                <div class="actBox">
                    <div class="actImg">
                        <img alt="" src="68227042_20071227.jpg" class="actor"> <!-- 여기에 배우 이미지 URL 추가 -->
                    </div>
                    <div class="actName" style="margin-top: 10px;">이름이</div>
                </div>
                <div class="actBox">
                    <div class="actImg">
                        <img alt="" src="68227042_20071227.jpg" class="actor"> <!-- 여기에 배우 이미지 URL 추가 -->
                    </div>
                    <div class="actName" style="margin-top: 10px;">이름이</div>
                </div>
            </div>
        </div>
    </section>
        <section class="show-text-area">
            <div class="show-text-container" style="margin-top: 62px;margin-left: -85px;">
                <span class="title title-actor">공연 정보</span>
                <textarea name="showInfo" class="show-text-field" placeholder="공연정보를 입력해 주세요" style="width: 993px; height: 250px; display: block; margin-top: 10px; resize: none;" ></textarea>
                <button type="submit" class="register-button" style="margin-left: 93.3%;margin-top: 20px;padding: 10px 20px; background-color: #ff9400; color: white; border: none; border-radius: 5px; cursor: pointer;">등록</button>
            </div>
            <!-- 모달 컨테이너 -->
<div id="actorModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <div class="search-bar">
            <input type="text" id="actorSearchInput" placeholder="배우 이름을 입력하세요">
            <button id="actorSearchButton">검색</button>
        </div>
        <div class="separator"></div>
        <section class="actor-area" id="actorSearchResults"></section>
    </div>
</div>
        </section>
    </form>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('poster').addEventListener('click', function() {
                document.getElementById('fileInput').click();
            });

            document.getElementById('fileInput').addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.querySelector('.poster').style.backgroundImage = `url(${e.target.result})`;
                    };
                    reader.readAsDataURL(file);
                }
            });
        });

        function setupTimeInput(countInputId, timeInputId) {
            document.getElementById(countInputId).addEventListener('click', function() {
                var timeInput = document.getElementById(timeInputId);
                timeInput.style.display = 'inline-block'; // 필드를 보이게 함
                timeInput.focus(); // 포커스 설정
            });

            document.getElementById(timeInputId).addEventListener('change', function() {
                var selectedTime = this.value; // 선택된 시간
                var formattedTime = selectedTime + ':00'; // 분 단위를 항상 00으로 설정

                document.getElementById(countInputId).value = (countInputId === '1회 ') + formattedTime;
                // 필요에 따라 시간 입력 필드를 숨길 수 있습니다.
                // this.style.display = 'none'; // 필드를 숨김 (선택적으로 사용)
            });
        }

        // 각 회차에 대해 시간 입력 필드 설정
        setupTimeInput('countInput1', 'timeInput1');

        document.getElementById('inputPriceField').addEventListener('input', function(e) {
            // 숫자만 남기기
            let value = e.target.value.replace(/[^0-9]/g, '');

            // 천 단위로 쉼표 추가
            value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ',');

            // 입력 필드에 값 설정
            e.target.value = value;
        });
        
	
	let isStartDateSelected = false;
	let startDate = null;
	let endDate = null;
	let currentDate = new Date(); // 현재 날짜를 기준으로 초기화
	
	function renderCalendar() {
	    const currentYear = currentDate.getFullYear();
	    const currentMonth = currentDate.getMonth(); // 월은 0부터 시작

    // 월과 연도를 업데이트
    const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    document.getElementById('currentMonthYear').textContent = `${monthNames[currentMonth]} ${currentYear}`;

    // 현재 월의 일 수를 정확히 계산
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

    const calendarDays = document.getElementById('calendarDays');
    calendarDays.innerHTML = ''; // 기존 날짜 제거

    for (let day = 1; day <= daysInMonth; day++) {
        const dayCell = document.createElement('div');
        dayCell.textContent = day;
        dayCell.classList.add('day');
        const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        dayCell.setAttribute('data-date', dateStr);

        const selectedDate = new Date(dateStr);

        // 첫 번째 날짜가 선택된 후, 이전 날짜는 회색으로 표시
        if (isStartDateSelected && selectedDate < startDate) {
            dayCell.classList.add('disabled');
        }

        // 두 번째 날짜가 선택된 후, 이후 날짜는 회색으로 표시
        if (endDate && selectedDate > endDate) {
            dayCell.classList.add('disabled');
        }

        dayCell.addEventListener('click', () => {
            if (dayCell.classList.contains('disabled')) {
                return; // 회색 날짜는 클릭 불가
            }

            document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));
            dayCell.classList.add('selected');

            if (!isStartDateSelected) {
                document.getElementById('startDateField').value = dateStr;
                startDate = selectedDate;
                isStartDateSelected = true;
                // 첫 번째 날짜 선택 후, 이전 날짜를 회색으로 변경
                document.querySelectorAll('.day').forEach(el => {
                    const elDate = new Date(el.getAttribute('data-date'));
                    if (elDate < startDate) {
                        el.classList.add('disabled');
                    }
                });
            } else {
                document.getElementById('endDateField').value = dateStr;
                endDate = selectedDate;
                isStartDateSelected = false;
                // 두 번째 날짜 선택 후, 구간 내의 날짜를 주황색 배경으로 표시
                document.querySelectorAll('.day').forEach(el => {
                    const elDate = new Date(el.getAttribute('data-date'));
                    if (elDate >= startDate && elDate <= endDate) {
                        el.classList.add('selected-range');
                    } else {
                        el.classList.remove('selected-range');
                    }
                    // 두 번째 날짜 이후의 날짜를 회색으로 변경
                    if (elDate > endDate) {
                        el.classList.add('disabled');
                    }
                });
            }
        });

	        calendarDays.appendChild(dayCell);
	    }
	}
	
	document.getElementById('prevMonth').addEventListener('click', () => {
	    currentDate.setMonth(currentDate.getMonth() - 1);
	    renderCalendar();
	});
	
	document.getElementById('nextMonth').addEventListener('click', () => {
	    currentDate.setMonth(currentDate.getMonth() + 1);
	    renderCalendar();
	});
	
	document.getElementById('resetSelection').addEventListener('click', () => {
	    // 선택 초기화
	    isStartDateSelected = false;
	    startDate = null;
	    endDate = null;
	    document.getElementById('startDateField').value = '';
	    document.getElementById('endDateField').value = '';
	    document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));
	    document.querySelectorAll('.disabled').forEach(el => el.classList.remove('disabled'));
	    document.querySelectorAll('.selected-range').forEach(el => el.classList.remove('selected-range'));
	});
	
	// 초기 달력 렌더링
	renderCalendar();
	
	
	document.addEventListener('DOMContentLoaded', function () {
	    // actBox 클릭 이벤트 위임
	    document.querySelector('.actor-input-container').addEventListener('click', function (event) {
	        const actBox = event.target.closest('.actBox'); // 클릭한 요소의 부모 중 .actBox 찾기
	        if (actBox) {
	            console.log('Clicked on actBox:', actBox); // 디버깅용
	            openActorModal(actBox); // 모달 열기
	        }
	    });

	    // 모달 열기
	    function openActorModal(actBox) {
	        const actorName = actBox.querySelector('.actName').textContent; // 배우 이름 가져오기
	        const actorImage = actBox.querySelector('.actImg img').src; // 배우 이미지 가져오기

	        const modal = document.getElementById('actorModal');
	        modal.style.display = 'flex'; // 모달 보이기

	        // 모달에 배우 정보 표시
	        modal.querySelector('.modal-actor-name').textContent = actorName;
	        modal.querySelector('.modal-actor-image').src = actorImage;

	        console.log(`Modal opened for actor: ${actorName}`);

	        // 모달 닫기 버튼
	        modal.querySelector('.close-button').addEventListener('click', function () {
	            closeActorModal();
	        });

	        // 모달 외부 클릭 시 닫기
	        modal.addEventListener('click', function (event) {
	            if (event.target === modal) {
	                closeActorModal();
	            }
	        });
	    }

	    // 모달 닫기
	    function closeActorModal() {
	        const modal = document.getElementById('actorModal');
	        modal.style.display = 'none'; // 모달 숨기기
	        console.log('Modal closed');
	    }
	});

    // 날짜를 yyyy-mm-dd 형식으로 파싱하는 함수
    function parseDate(dateString) {
        var parts = dateString.split('-');
        return new Date(parts[0], parts[1] - 1, parts[2]);
    }

    // startDate를 기준으로 7일 전 날짜 계산
    function calculateOpenDate() {
        var startDateField = document.getElementById('startDateField');
        var startDate = startDateField.value;

        if (startDate) {
            var startDateObj = parseDate(startDate);
            var openDateObj = new Date(startDateObj);  // startDate 복제
            openDateObj.setDate(startDateObj.getDate() - 7);  // 7일 전으로 설정

            // openDateField에 계산된 날짜 설정
            var openDateField = document.getElementById('openDateField');
            var formattedDate = openDateObj.toISOString().split('T')[0];  // yyyy-mm-dd 형식
            openDateField.value = formattedDate;
        }
    }

    // startDate가 변경될 때마다 openDate를 계산하도록 설정
    document.getElementById('startDateField').addEventListener('change', calculateOpenDate);
	

</script>
</body>
</html>